version: '3.8'

services:
  web:
    build: .
    container_name: sprintix-web-java
    restart: unless-stopped
    ports:
      - "4000:8081"
    environment:
      # Para peticiones SERVIDOR -> API (dentro de Docker)
      # Usa el nombre del contenedor de la API
      - API_URL_BACKEND=http://sprintix-api:8080/api
      
      # Para peticiones NAVEGADOR -> API (fuera de Docker)
      # El navegador no puede acceder a "sprintix-api", debe usar localhost
      - API_URL_PUBLIC=http://localhost:8080/api
    networks:
      - api-proyecto_sprintix-network
    # Opcional: healthcheck para verificar que el servicio est√° listo
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8081/config"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

networks:
  api-proyecto_sprintix-network:
    external: true